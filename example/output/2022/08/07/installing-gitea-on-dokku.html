<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

	<title>David Díaz  | Installing Gitea on Dokku </title>

	<link rel="stylesheet" href="/css/screen.css">
	<link rel="alternate" type="application/rss+xml" title="RSS Feed for martianwabbit.com" href="https://martianwabbit.com/feed.xml" />
	<link rel="me" href="https://mastodon.social/@seich" />
</head>
<body>
<div id="top">
	<h1><a href="/">David Díaz<span>.</span></a></h1>
</div>

<header>
  <h1>
    <a href="">Installing Gitea on Dokku</a>
  </h1>

  <aside>
    <time>Posted on: August 07, 2022</time>
    <span>227 Words</span>
    <span
      >Takes 1 minutes to read</span
    >
  </aside>
</header>
<article>
  <p>I've been meaning to backup my GitHub repos somewhere for a while. I recently
discovered that Gitea can mirror them and will keep them updated. I am running
Dokku on my dedicated server and pretty much run everything I can think of
there. Gitea was a bit tricky to install so here are some notes.</p>
<p>You start by creating the app:</p>
<pre><code>; dokku app:create gitea
</code></pre>
<p>Once that's done, we can initialize it from the docker image:</p>
<pre><code>; dokku git:from-image gitea gitea/gitea:latest
</code></pre>
<p>This is a good time to set the correct domain name and mount the Gitea
directories.</p>
<pre><code>; dokku domains:add gitea git.example.org
; dokku storage:ensure-directory gitea
; dokku storage:mount gitea /var/lib/dokku/data/storage/gitea:/data
</code></pre>
<p>We can rebuild the app now:</p>
<pre><code>; dokku ps:rebuild gitea
</code></pre>
<p>Dokku will get some ports wrong sometimes, we should check those:</p>
<pre><code>; dokku proxy:report gitea
=====> gitea proxy information
       Proxy enabled:                 true
       Proxy port map:                http:22:22 http:3000:3000
       Proxy type:                    nginx

</code></pre>
<p>Those look somewhat wrong, lets fix them:</p>
<pre><code>; dokku proxy:ports-remove gitea http:3000:3000 http:22:22
; dokku proxy:ports-add gitea http:80:3000
</code></pre>
<p>We can enable LetsEncrypt now:</p>
<pre><code>; dokku letsencrypt:enable gitea
</code></pre>
<p>That's pretty much it! Seems a lot simpler once I've written it down.
If you want to change the config file you can go ahead and edit it + restart the
app:</p>
<pre><code>; sudo vim /var/lib/dokku/data/storage/gitea/gitea/conf/app.ini
; dokku ps:restart gitea
</code></pre>
<p>Cheers!</p>

  <p class="comments">
    Have a comment? Feel free to
    <a href="mailto:seich@martianwabbit.com">email me</a>.<br />
    Did you enjoy this post?
    <a href="https://www.buymeacoffee.com/seich">Buy me a coffee ☕️</a>.
  </p>
</article>


<footer>
	<p>David Díaz © All Rights Reserved.</p>
</footer>
</body>
</html>
